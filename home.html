<!doctype html>
<html lang="en">
<head>
    <title>Dashboard</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --navy: #102E50;
            --gold: #F5C45E;
            --orange: #E78B48;
            --red: #BE3D2A;
            --light-gold: #FDF4D3;
            --light-orange: #FFF0E6;
        }
        body { background: linear-gradient(135deg, var(--navy) 0%, #1a3a5c  50%, #2a4a6c 100%); min-height: 100vh; }
        .favorite-card { 
            cursor: pointer; 
            transition: all 0.3s; 
            border: 2px solid var(--gold);
            background: linear-gradient(135deg, var(--light-gold) 0%, white 100%);
        }
        .favorite-card:hover { transform: translateY(-8px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
        .task-item { 
            border-left: 4px solid var(--orange); 
            background: linear-gradient(135deg, white 0%, var(--light-orange) 100%);
            border-radius: 10px;
            color: var(--navy);
        }
        .task-completed { 
            text-decoration: line-through; 
            opacity: 0.6; 
            border-left-color: var(--gold);
            background: linear-gradient(135deg, var(--light-gold) 0%, #f0f8e8 100%);
            color: var(--navy);
        }
        .stats-card { 
            background: linear-gradient(135deg, var(--navy) 0%, var(--orange) 100%); 
            color: white;
            border-radius: 15px;
        }
        .favicon { width: 24px; height: 24px; margin-right: 8px; }
        .card { 
            border-radius: 15px; 
            border: 2px solid var(--gold);
            box-shadow: 0 4px 15px rgba(16, 46, 80, 0.15);
            color: var(--navy);
        }
        .btn-primary { background: var(--navy); border-color: var(--navy); }
        .btn-success { background: var(--gold); border-color: var(--gold); color: var(--navy); }
        .btn-danger { background: var(--red); border-color: var(--red); }
        .btn-warning { background: var(--orange); border-color: var(--orange); color: white; }
        .btn-info { background: var(--orange); border-color: var(--orange); }
        .modal-content { border-radius: 15px; border: 2px solid var(--gold); }
        .form-control { border: 2px solid var(--light-gold); border-radius: 10px; }
        .form-control:focus { border-color: var(--orange); box-shadow: 0 0 0 0.2rem rgba(231, 139, 72, 0.25); }
        #currentDateTime {
            background: linear-gradient(45deg, var(--gold), var(--orange), var(--red), var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 2rem;
        }
        h2, h5, h6 { color: white; }
        .card h5, .card h6 { color: var(--navy); }
        .text-muted { color: #6c757d !important; }
    </style>
</head>
<body>
    <div class="container-fluid p-3">
        <!-- Header -->
        <div class="row mb-5" style="margin-top: 3rem;">
            <div class="col-12">
                <div class="text-center">
                    <div id="currentTime" style="font-size: 4.5rem; font-weight: bold; background: linear-gradient(45deg, var(--gold), var(--orange), var(--red), var(--gold)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);"></div>
                    <div id="currentDate" style="font-size: 1.2rem; color: rgba(255,255,255,0.8); margin-top: 0.5rem; text-transform: lowercase;"></div>
                </div>
            </div>
        </div>

        <!-- Favorite Pages Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5><i class="fas fa-star text-warning"></i> Favorite Pages</h5>
                    <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#addFavoriteModal">
                        <i class="fas fa-plus"></i> Add Favorite
                    </button>
                </div>
                <div id="favoritesContainer" class="row"></div>
            </div>
        </div>

        <!-- Task Manager Section -->
        <div class="row">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-tasks"></i> Task Manager</h5>
                        <button class="btn btn-success btn-sm" data-toggle="modal" data-target="#addTaskModal">
                            <i class="fas fa-plus"></i> Add Task
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <input type="date" id="taskDate" class="form-control" onchange="loadTasks()">
                        </div>
                        <div id="tasksContainer"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card stats-card mb-3">
                    <div class="card-body text-center">
                        <h3 id="todayTaskCount">0</h3>
                        <p>Today's Tasks</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h6><i class="fas fa-history"></i> Task History</h6>
                    </div>
                    <div class="card-body">
                        <div id="taskStats"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Favorite Modal -->
    <div class="modal fade" id="addFavoriteModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5>Add Favorite Page</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="favoriteForm">
                        <div class="form-group">
                            <label>Title</label>
                            <input type="text" class="form-control" id="favoriteTitle" required>
                        </div>
                        <div class="form-group">
                            <label>URL</label>
                            <input type="url" class="form-control" id="favoriteUrl" required>
                        </div>
                        <div class="form-group">
                            <label>Custom Icon URL (optional)</label>
                            <input type="url" class="form-control" id="favoriteIcon" placeholder="Leave empty for auto favicon">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveFavorite()">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Task Modal -->
    <div class="modal fade" id="addTaskModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5>Add Task</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="taskForm">
                        <div class="form-group">
                            <label>Task Title</label>
                            <input type="text" class="form-control" id="taskTitle" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea class="form-control" id="taskDescription" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" class="form-control" id="taskDateInput" required>
                        </div>
                        <div class="form-group">
                            <label>Time</label>
                            <input type="time" class="form-control" id="taskTime">
                        </div>
                        <div class="form-group">
                            <label>Estimated Duration (minutes)</label>
                            <input type="number" class="form-control" id="taskDuration" min="1">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="saveTask()">Save Task</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    
    <script>
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateDateTime();
            setInterval(updateDateTime, 1000);
            document.getElementById('taskDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('taskDateInput').value = new Date().toISOString().split('T')[0];
            loadFavorites();
            loadTasks();
            updateTaskStats();
        });

        function updateDateTime() {
            const now = new Date();
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            
            document.getElementById('currentTime').textContent = now.toLocaleTimeString([], timeOptions);
            document.getElementById('currentDate').textContent = now.toLocaleDateString([], dateOptions);
        }

        // Favorites Management
        function loadFavorites() {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const container = document.getElementById('favoritesContainer');
            container.innerHTML = '';
            
            favorites.forEach((fav, index) => {
                const domain = new URL(fav.url).hostname;
                const iconUrl = fav.icon || `https://www.google.com/s2/favicons?domain=${domain}`;
                container.innerHTML += `
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card favorite-card h-100" onclick="window.open('${fav.url}', '_blank')" style="position: relative;">
                            <div class="card-body text-center">
                                <div style="position: absolute; top: 5px; right: 5px; display: flex; flex-direction: column;">
                                    <button class="btn btn-xs btn-info mb-1" style="padding: 1px 4px; font-size: 8px;" onclick="event.stopPropagation(); moveFavorite(${index}, 'up')">
                                        <i class="fas fa-arrow-up"></i>
                                    </button>
                                    <button class="btn btn-xs btn-info mb-1" style="padding: 1px 4px; font-size: 8px;" onclick="event.stopPropagation(); moveFavorite(${index}, 'down')">
                                        <i class="fas fa-arrow-down"></i>
                                    </button>
                                    <button class="btn btn-xs btn-warning mb-1" style="padding: 1px 4px; font-size: 8px;" onclick="event.stopPropagation(); editFavorite(${index})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-xs btn-danger" style="padding: 1px 4px; font-size: 8px;" onclick="event.stopPropagation(); deleteFavorite(${index})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                <img src="${iconUrl}" class="favicon" alt="">
                                <h6 class="card-title mt-2">${fav.title}</h6>
                                <small class="text-muted">${domain}</small>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        let editingFavoriteIndex = -1;
        
        function saveFavorite() {
            const title = document.getElementById('favoriteTitle').value;
            const url = document.getElementById('favoriteUrl').value;
            const icon = document.getElementById('favoriteIcon').value;
            
            if (title && url) {
                const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
                const favorite = { title, url, icon };
                
                if (editingFavoriteIndex >= 0) {
                    favorites[editingFavoriteIndex] = favorite;
                } else {
                    favorites.push(favorite);
                }
                
                localStorage.setItem('favorites', JSON.stringify(favorites));
                document.getElementById('favoriteForm').reset();
                $('#addFavoriteModal').modal('hide');
                editingFavoriteIndex = -1;
                loadFavorites();
            }
        }
        
        function editFavorite(index) {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const fav = favorites[index];
            
            document.getElementById('favoriteTitle').value = fav.title;
            document.getElementById('favoriteUrl').value = fav.url;
            document.getElementById('favoriteIcon').value = fav.icon || '';
            
            editingFavoriteIndex = index;
            $('#addFavoriteModal').modal('show');
        }

        function deleteFavorite(index) {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            favorites.splice(index, 1);
            localStorage.setItem('favorites', JSON.stringify(favorites));
            loadFavorites();
        }
        
        function moveFavorite(index, direction) {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const newIndex = direction === 'up' ? index - 1 : index + 1;
            
            if (newIndex >= 0 && newIndex < favorites.length) {
                [favorites[index], favorites[newIndex]] = [favorites[newIndex], favorites[index]];
                localStorage.setItem('favorites', JSON.stringify(favorites));
                loadFavorites();
            }
        }

        // Task Management
        function loadTasks() {
            const selectedDate = document.getElementById('taskDate').value;
            const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            const dayTasks = tasks.filter(task => task.date === selectedDate);
            
            const container = document.getElementById('tasksContainer');
            container.innerHTML = '';
            
            if (dayTasks.length === 0) {
                container.innerHTML = '<p class="text-muted text-center">No tasks for this day</p>';
                return;
            }
            
            dayTasks.forEach((task, index) => {
                const taskIndex = tasks.findIndex(t => t.id === task.id);
                container.innerHTML += `
                    <div class="card mb-2 task-item ${task.completed ? 'task-completed' : ''}">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start">
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">${task.title}</h6>
                                    <p class="mb-1 text-muted">${task.description}</p>
                                    <small class="text-muted">
                                        <i class="fas fa-clock"></i> ${task.time || 'No time set'}
                                        ${task.duration ? `| <i class="fas fa-hourglass-half"></i> ${task.duration}min` : ''}
                                    </small>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-sm ${task.completed ? 'btn-warning' : 'btn-success'}" 
                                            onclick="toggleTask(${taskIndex})">
                                        <i class="fas ${task.completed ? 'fa-undo' : 'fa-check'}"></i>
                                    </button>
                                    <button class="btn btn-sm btn-info" onclick="editTask(${taskIndex})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteTask(${taskIndex})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('todayTaskCount').textContent = dayTasks.length;
        }

        let editingTaskIndex = -1;
        
        function saveTask() {
            const title = document.getElementById('taskTitle').value;
            const description = document.getElementById('taskDescription').value;
            const date = document.getElementById('taskDateInput').value;
            const time = document.getElementById('taskTime').value;
            const duration = document.getElementById('taskDuration').value;
            
            if (title && date) {
                const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
                const task = {
                    title,
                    description,
                    date,
                    time,
                    duration,
                    completed: false
                };
                
                if (editingTaskIndex >= 0) {
                    task.id = tasks[editingTaskIndex].id;
                    task.completed = tasks[editingTaskIndex].completed;
                    task.createdAt = tasks[editingTaskIndex].createdAt;
                    tasks[editingTaskIndex] = task;
                } else {
                    task.id = Date.now();
                    task.createdAt = new Date().toISOString();
                    tasks.push(task);
                }
                
                localStorage.setItem('tasks', JSON.stringify(tasks));
                document.getElementById('taskForm').reset();
                $('#addTaskModal').modal('hide');
                editingTaskIndex = -1;
                loadTasks();
                updateTaskStats();
            }
        }
        
        function editTask(index) {
            const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            const task = tasks[index];
            
            document.getElementById('taskTitle').value = task.title;
            document.getElementById('taskDescription').value = task.description;
            document.getElementById('taskDateInput').value = task.date;
            document.getElementById('taskTime').value = task.time || '';
            document.getElementById('taskDuration').value = task.duration || '';
            
            editingTaskIndex = index;
            $('#addTaskModal').modal('show');
        }

        function toggleTask(index) {
            const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            tasks[index].completed = !tasks[index].completed;
            localStorage.setItem('tasks', JSON.stringify(tasks));
            loadTasks();
            updateTaskStats();
        }

        function deleteTask(index) {
            const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            tasks.splice(index, 1);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            loadTasks();
            updateTaskStats();
        }

        function updateTaskStats() {
            const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            const today = new Date().toISOString().split('T')[0];
            const todayTasks = tasks.filter(task => task.date === today);
            const completedToday = todayTasks.filter(task => task.completed).length;
            const totalTasks = tasks.length;
            const totalCompleted = tasks.filter(task => task.completed).length;
            
            document.getElementById('taskStats').innerHTML = `
                <div class="mb-2">
                    <small class="text-muted">Today: ${completedToday}/${todayTasks.length}</small>
                    <div class="progress" style="height: 5px;">
                        <div class="progress-bar" style="width: ${todayTasks.length ? (completedToday/todayTasks.length)*100 : 0}%"></div>
                    </div>
                </div>
                <div class="mb-2">
                    <small class="text-muted">Overall: ${totalCompleted}/${totalTasks}</small>
                    <div class="progress" style="height: 5px;">
                        <div class="progress-bar bg-success" style="width: ${totalTasks ? (totalCompleted/totalTasks)*100 : 0}%"></div>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
